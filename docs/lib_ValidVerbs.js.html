<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib/ValidVerbs.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Commons.html">Commons</a><ul class='methods'><li data-type='method'><a href="Commons.html#chunkArray">chunkArray</a></li><li data-type='method'><a href="Commons.html#filedNameMachs">filedNameMachs</a></li><li data-type='method'><a href="Commons.html#getVerbConfig">getVerbConfig</a></li><li data-type='method'><a href="Commons.html#getVerbsInString">getVerbsInString</a></li><li data-type='method'><a href="Commons.html#isEmpty">isEmpty</a></li><li data-type='method'><a href="Commons.html#isLanguageISO">isLanguageISO</a></li><li data-type='method'><a href="Commons.html#isValidDate">isValidDate</a></li><li data-type='method'><a href="Commons.html#isValidVerb">isValidVerb</a></li><li data-type='method'><a href="Commons.html#logicalConfirmDeepMap">logicalConfirmDeepMap</a></li><li data-type='method'><a href="Commons.html#paramValidator">paramValidator</a></li><li data-type='method'><a href="Commons.html#replaceAll">replaceAll</a></li><li data-type='method'><a href="Commons.html#ruleDateValidator">ruleDateValidator</a></li><li data-type='method'><a href="Commons.html#ruleGeneralValidator">ruleGeneralValidator</a></li><li data-type='method'><a href="Commons.html#ruleInDeepValidator">ruleInDeepValidator</a></li><li data-type='method'><a href="Commons.html#topKeyValidator">topKeyValidator</a></li><li data-type='method'><a href="Commons.html#validRules">validRules</a></li></ul></li><li><a href="JCompiler.html">JCompiler</a><ul class='methods'><li data-type='method'><a href="JCompiler.html#loadPNS">loadPNS</a></li></ul></li><li><a href="Parser.html">Parser</a><ul class='methods'><li data-type='method'><a href="Parser.html#extractValue">extractValue</a></li><li data-type='method'><a href="Parser.html#loadConditions">loadConditions</a></li><li data-type='method'><a href="Parser.html#loadConditionsImplement">loadConditionsImplement</a></li><li data-type='method'><a href="Parser.html#loadPreProcessVerbs">loadPreProcessVerbs</a></li><li data-type='method'><a href="Parser.html#rawContentParser">rawContentParser</a></li><li data-type='method'><a href="Parser.html#rawTargetParser">rawTargetParser</a></li></ul></li><li><a href="ResultCalculator.html">ResultCalculator</a><ul class='methods'><li data-type='method'><a href="ResultCalculator.html#collectConditionResults">collectConditionResults</a></li></ul></li></ul><h3>Namespaces</h3><ul><li><a href="Operands.html">Operands</a></li><li><a href="verbList.html">verbList</a></li></ul><h3>Global</h3><ul><li><a href="global.html#selectOperands">selectOperands</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">lib/ValidVerbs.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

/**
 * @namespace  verbList
 * @desc &lt;p> the valid verbs&lt;/p&lt;br>
 * @property {email_address}                                 - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.like like}                           - top Key: device
 * @property {mobile_number}                                 - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.like like}                           - top Key: device
 * @property {firstname}                                     - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.like like}                           - top Key: device
 * @property {lastname}                                      - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.like like}                           - top Key: device
 * @property {gender}                                        - allowed operands   {@link Operands.eql eql}
 *                                                           - top Key: device
 * @property {date_of_birth}                                 - allowed operands   {@link Operands.today today},
 *      {@link Operands.equalExactDate equalExactDate}       - top Key: device
 * @property {passport_expiry}                               - allowed operands   {@link Operands.next next},
 *      {@link Operands.next next},
 *      {@link Operands.today today},
 *      {@link Operands.equalExactDate equalExactDate}       - top Key:  device
 * @property {language}                                      - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.exList exList}                       - top key: device
 * @property {currency}                                      - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList}                       - top Key:  device
 * @property {hometown}                                      - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList}                       - top Key:  device
 * @property {country}                                       - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList}                       - top Key:  device
 * @property {is_member}                                     - allowed operands   {@link Operands.eql eql}
 *                                                           - top Key:  device
 * @property {flight_stats_notification}                     - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList}                       - top Key: device
 * @property {campaign_notification}                         - allowed operands   {@link Operands.eql eql}
 *                                                           - top Key: device
 * @property {app_version}                                   - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList},
 *      {@link Operands.like like}                           - top Key:  device
 * @property {device_type}                                   - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList},
 *      {@link Operands.like like}                           - top Key:  device
 * @property {device_os_version}                             - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList},
 *      {@link Operands.like like}                           -  top Key:  device
 * @property {device_locale}                                 - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList}                       - top Key:  device
 * @property {pnr}                                           - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList},
 *      {@link Operands.like like}                           - top Key:  booking
 * @property {flight_number}                                 - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList},
 *      {@link Operands.like like}                           - top Key:  flight
 * @property {origin_airport}                                - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList},
 *      {@link Operands.like like}                           - top Key:  flight
 * @property {destination_airport_IATA_CODE}                 - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList}                       - top Key:  flight
 * @property {destination_airport_city_name}                 - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList}                       - top Key:  flight
 * @property {std}                                           - allowed operands   {@link Operands.next next},
 *      {@link Operands.last last},
 *      {@link Operands.today today},
 *      {@link Operands.equalExactDate equalExactDate}       - top Key:  flight
 * @property {sta}                                           - allowed operands   {@link Operands.next next},
 *      {@link Operands.next next},
 *      {@link Operands.today today},
 *      {@link Operands.equalExactDate equalExactDate}       - top Key:  flight
 * @property {passenger_count}                               - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.lessThan lessThan},
 *      {@link Operands.greaterThan greaterThan},
 *      {@link Operands.inList inList},
 *      {@link Operands.between between}                     - top Key:  booking
 * @property {child_count}                                   - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.lessThan lessThan},
 *      {@link Operands.greaterThan greaterThan},
 *      {@link Operands.inList inList},
 *      {@link Operands.between between}                     - top Key:  booking
 * @property {infant_count}                                  - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.lessThan lessThan},
 *      {@link Operands.greaterThan greaterThan},
 *      {@link Operands.inList inList},
 *      {@link Operands.between between}                     - top key:  booking
 * @property {payment_status}                                - allowed operands   {@link Operands.eql eql},
 *      {@link Operands.inList inList},
 *      {@link Operands.inList inList}                       - top Key: booking
 * @property {payment_hold_datetime}                         - allowed operands   {@link Operands.next next},
 *      {@link Operands.next next},
 *      {@link Operands.today today},
 *      {@link Operands.equalExactDate equalExactDate}       - top key:  booking
 * @property {current_location_city_name}                    - allowed operands   {@link Operands.eql eql}
 *                                                           - top key:  device
 * @property {average_flight_per_month_exclude_to_month_ago} - allowed operands   {@link Operands.eql eql},
 * {@link Operands.greaterThan greaterThan},
 * {@link Operands.lessThan lessThan}                        - top Key:  flight

 */

const verbList = [
  {
    'email_address': {
      maps: ['devices', 'email_address'],
      acceptableOperand: ['eql','like'],
      fieldName: 'email_address',
    },
  },
  {
    'mobile_number': {
      maps: ['devices', 'mobile_number'],
      acceptableOperand: ['eql','like'],
      fieldName: 'mobile_number',
    },
  },
  {
    'firstname': {
      maps: ['devices', 'firstname'],
      acceptableOperand: ['eql','like'],
      fieldName: 'firstname',
    },
  },
  {
    'lastname': {
      maps: ['devices', 'lastname'],
      acceptableOperand: ['eql','like'],
      fieldName: 'lastname',
    },
  },
  {
    'gender': {
      maps: ['devices', 'gender'],
      acceptableOperand: ['eql'],
      fieldName: 'gender',
      valuePreProcessor: v => {
        const newVal = {};
        const manWords = ['man', 'm', 'male', 'boy'];

        Object.keys(v).
          forEach(key => {
            newVal[key] = manWords.map(menWord => menWord.toLowerCase()).
              indexOf(v[key].val) != -1 ? 1 : 0;
          });

        return newVal;
      },
    },
  },
  {
    'date_of_birth': {
      maps: ['devices', 'date_of_birth'],
      acceptableOperand: ['today', 'equalExactDate'],
      fieldName: 'date_of_birth',
    },
  },
  {
    'passport_expiry': {
      maps: ['devices', 'passport_expiry'],
      acceptableOperand: ['next', 'last', 'today', 'equalExactDate'],
      fieldName: 'passport_expiry',
    },
  },
  {
    'language': {
      maps: ['devices', 'language'],
      acceptableOperand: ['eql', 'inList', 'exList'],
      fieldName: 'language',
      valuePreProcessor: v => v.toLowerCase(),
    },
  },
  {
    'currency': {
      maps: ['devices', 'currency'],
      acceptableOperand: ['eql', 'inList', 'exList'],
      fieldName: 'currency',
      valuePreProcessor: v => v.toLowerCase(),
    },
  },
  {
    'hometown': {
      maps: ['devices', 'city'],
      acceptableOperand: ['eql', 'inList', 'exList'],
      fieldName: 'city',
    },
  },
  {
    'country': {
      maps: ['devices', 'country'],
      acceptableOperand: ['eql', 'inList', 'exList'],
      fieldName: 'country',
    },
  },
  {
    'is_member': {
      maps: ['devices', 'is_member'],
      acceptableOperand: ['eql'],
      fieldName: 'gender',
      valuePreProcessor: v => {
        const newVal = {};
        const manWords = ['yes', 'true'];

        Object.keys(v).
          forEach(key => {
            newVal[key] = manWords.map(menWord => menWord.toLowerCase()).
              indexOf(v[key]) != -1 ? 1 : 0;
          });

        return newVal;
      },
    },
  },
  {
    'flight_stats_notification': {
      maps: ['devices', 'flight_stats_notification'],
      acceptableOperand: ['eql', 'inList', 'exList'],
      fieldName: 'flight_stats_notification',
      valuePreProcessor: v => {
        const newVal = {};
        const manWords = ['true', 'active'];

        Object.keys(v).
          forEach(key => {
            newVal[key] = manWords.map(menWord => menWord.toLowerCase()).
              indexOf(v[key]) !== -1 ? 1 : 0;
          });

        return newVal;
      },
    },
  },
  {
    'campaign_notification': {
      maps: ['devices', 'gender'],
      acceptableOperand: ['eql'],
      fieldName: 'gender',
      valuePreProcessor: v => {
        const newVal = {};
        const manWords = ['true', 'active'];

        Object.keys(v).
          forEach(key => {
            newVal[key] = manWords.map(menWord => menWord.toLowerCase()).
              indexOf(v[key]) !== -1 ? 1 : 0;
          });

        return newVal;
      },
    },
  },
  {
    'app_version': {
      maps: ['devices', 'app_version'],
      acceptableOperand: ['eql', 'inList', 'exList','like'],
      fieldName: 'app_version',
    },
  },
  {
    'device_type': {

      maps: ['devices', 'device_type'],
      acceptableOperand: ['eql', 'inList', 'exList','like'],
      fieldName: 'device_type',
    },
  },
  {
    'device_os_version': {
      maps: ['devices', 'device_os_version'],
      acceptableOperand: ['eql', 'inList', 'exList','like'],
      fieldName: 'device_os_version',
    },
  },
  {
    'device_locale': {
      maps: ['devices', 'device_locale'],
      acceptableOperand: ['eql', 'inList', 'exList'],
      fieldName: 'device_locale',
      valuePreProcessor: v => v.toLowerCase(),
    },
  },
  {
    'pnr': {
      maps: ['bookings', 'pnr'],
      acceptableOperand: ['eql', 'inList', 'exList','like'],
      fieldName: 'pnr',
    },
  },
  {
    'flight_number': {
      maps: ['flights', 'flight_number'],
      acceptableOperand: ['eql', 'inList', 'exList','like'],
      fieldName: 'flight_number',
    },
  },
  {
    'origin_airport': {

      maps: ['flights', 'origin'],
      acceptableOperand: ['eql', 'inList', 'exList','like'],
      fieldName: 'origin_airport',
    },
  },
  {
    'destination_airport_IATA_CODE': {

      maps: ['flights', 'destination'],
      acceptableOperand: ['eql', 'inList', 'exList'],
      fieldName: 'destination_airport',
    },
  },
  {
    'destination_airport_city_name': {
      maps: ['T_flights', 'F_destination',
        'F_iata_code', 'T_airports', 'F_city',
        'F_id', 'T_cities', 'F_name'],
      acceptableOperand: ['eql', 'inList', 'exList'],
      fieldName: 'destination_airport',
    },
  },
  {
    'std': {
      maps: ['flights', 'std'],
      acceptableOperand: ['next', 'last', 'today', 'equalExactDate'],
      fieldName: 'std',
    },
  },
  {
    'sta': {
      maps: ['flights', 'sta'],
      acceptableOperand: ['next', 'last', 'today', 'equalExactDate'],
      fieldName: 'sta',
    },
  },
  {
    'passenger_count': {
      maps: ['bookings', 'passenger_count'],
      acceptableOperand: [
        'eql',
        'lessThan',
        'greaterThan',
        'exList',
        'between'],
      fieldName: 'passenger_count',
    },
  },
  {
    'child_count': {
      maps: ['bookings', 'child_count'],
      acceptableOperand: [
        'eql',
        'lessThan',
        'greaterThan',
        'exList',
        'between'],
      fieldName: 'child_count',
    },
  },
  {
    'infant_count': {
      maps: ['bookings', 'infant_count'],
      acceptableOperand: [
        'eql',
        'lessThan',
        'greaterThan',
        'exList',
        'between'],
      fieldName: 'infant_count',
    },
  },
  {
    'payment_status': {
      maps: ['bookings', 'status'],
      acceptableOperand: ['eql', 'inList', 'exList'],
      fieldName: 'payment_status',
    },
  },
  {
    'payment_hold_datetime': {
      maps: ['bookings', 'hold_datetime'],
      acceptableOperand: ['next', 'last', 'today','equalExactDate'],
      fieldName: 'std',
    },
  },
  {
    'current_location_city_name': {
      maps: ['devices', 'appengine_city'],
      acceptableOperand: ['eql'],
      fieldName: 'appengine_city_under_device',
    },
  },
  {
    'average_flight_per_month_exclude_to_month_ago': {
      maps: ['T_flights', 'F_STD', 'C_count', 'C_last_2_M', 'POST_avrage_per_month'],
      acceptableOperand: ['eql', 'greaterThan', 'lessThan'],
      fieldName: 'average_flight_per_month',
    },
  },

  /* ,
  {"checkin_status": ""}, todo -> ask nazar
  {"geofence": ""}, //
  {"latitude": ""},
  {"longitude": ""},
  {"radius": ""}*/
].reduce((p, v) => {
  const key = Object.keys(v)[0];

  p[key] = {
    maps: v[key].maps || [],
    acceptableOperand: v[key].acceptableOperand || [],
    fieldName: key,
    get isDevice() {
      return this.maps[0] === 'devices' || this.maps[0].replace('T_', '')==='devices';
    },
    get isFlight() {
      return this.maps[0] === 'flights' || this.maps[0].replace('T_', '')==='flights';
    },
    get isBooking() {
      return this.maps[0] === 'bookings' || this.maps[0].replace('T_', '')==='bookings';
    },
    isValidScope(scope) {
      let res=false;

      switch (scope.toLowerCase()) {
        case 'device':
          res=this.isDevice;
          break;
        case 'flight':
          res=this.isFlight;
          break;
        case 'booking':
          res=this.isBooking;
          break;
      }

      return res;
    },
    get shouldPreProcessed() {
      return this.maps.length >2;
    },
    get calcRequired() {
      return this.maps.filter(item=>item.startsWith('C_')).length>0;
    },
    valuePreProcessor: v[key].valuePreProcessor || function(value) {
      return value;
    },
  };

  return p;
}, {});

module.exports = verbList;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Jan 16 2018 12:28:00 GMT+0800 (+08) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
